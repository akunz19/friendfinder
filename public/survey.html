<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>    
    <title>Friend Quiz</title>
</head>
<body>
    <h1>The Matchelor!</h1>
    <form id="myform">
    <div class="form-group">
      <label for="name">First name</label>
      <input type="text" class="form-control" id="name" placeholder="Name">
    </div>
    <div class="form-group">
      <label for="imgurl">Profile Picture</label>
      <input type="text" class="form-control" id="imgurl" placeholder="imgurl">
    </div>
    <div class='form-group container question-class question-div-1' id='1'>
            <h3>How much clarity do you feel you've reached over the past year?</h3>
            <div class="input-group mb-3">
                    <div class="input-group-prepend">
                      <label class="input-group-text" for="inputGroupSelect01">Options</label>
                    </div>
                    <select class="custom-select" id="1">
                      <option value="select">Select</option>
                      <option value="1">1</option>
                      <option value="2">2</option>
                      <option value="3">3</option>
                      <option value="4">4</option>
                      <option value="5">5</option>
                    </select>
                  </div>
    </div>
    <div class='form-group container question-class question-div-2' id='2'>
            <h3>How ready are you to find love?</h3>
            <div class="input-group mb-3">
                    <div class="input-group-prepend">
                      <label class="input-group-text" for="inputGroupSelect01">Options</label>
                    </div>
                    <select class="custom-select" id="2">
                      <option value="select">Select</option>
                      <option value="1">1</option>
                      <option value="2">2</option>
                      <option value="3">3</option>
                      <option value="4">4</option>
                      <option value="5">5</option>
                    </select>
                  </div>
    </div>
    <div class='form-group container question-class question-div-3' id='3'>
            <h3>Would you say you are an open person?</h3>
                <div class="input-group mb-3">
                    <div class="input-group-prepend">
                      <label class="input-group-text" for="inputGroupSelect01">Options</label>
                    </div>
                    <select class="custom-select" id="3">
                      <option value="select">Select</option>
                      <option value="1">1</option>
                      <option value="2">2</option>
                      <option value="3">3</option>
                      <option value="4">4</option>
                      <option value="5">5</option>
                    </select>
                  </div>

    </div>
    <div class='form-group container question-class question-div-4' id='4'>
            <h3>Are you here for the right reasons?</h3>
                <div class="input-group mb-3">
                    <div class="input-group-prepend">
                      <label class="input-group-text" for="inputGroupSelect01">Options</label>
                    </div>
                    <select class="custom-select" id="4">
                      <option value="select">Select</option>
                      <option value="1">1</option>
                      <option value="2">2</option>
                      <option value="3">3</option>
                      <option value="4">4</option>
                      <option value="5">5</option>
                    </select>
                  </div>

    </div>
    <div class='form-group container question-class question-div-5' id='5'>
         <h3>How good do you look in sequins?</h3>
            <div class="input-group mb-3">
                    <div class="input-group-prepend">
                      <label class="input-group-text" for="inputGroupSelect01">Options</label>
                    </div>
                    <select class="custom-select" id="5">
                      <option value="select">Select</option>
                      <option value="1">1</option>
                      <option value="2">2</option>
                      <option value="3">3</option>
                      <option value="4">4</option>
                      <option value="5">5</option>
                     </select>
                  </div>

    </div>
    <div class='form-group container question-class question-div-6' id='6'>
            <h3>Would you accept this rose?</h3>
            <div class="input-group mb-3">
                    <div class="input-group-prepend">
                      <label class="input-group-text" for="inputGroupSelect01">Options</label>
                    </div>
                    <select class="custom-select" id="6">
                      <option value="select">Select</option>
                      <option value="1">1</option>
                      <option value="2">2</option>
                      <option value="3">3</option>
                      <option value="4">4</option>
                      <option value="5">5</option>
                    </select>
                  </div>

    </div>
    <div class='form-group container question-class question-div-7' id='7'>
            <h3>Do you feel like this is your last chance to find love?</h3>
            <div class="input-group mb-3">
                    <div class="input-group-prepend">
                      <label class="input-group-text" for="inputGroupSelect01">Options</label>
                    </div>
                    <select class="custom-select" id="7">
                      <option value="select">Select</option>
                      <option value="1">1</option>
                      <option value="2">2</option>
                      <option value="3">3</option>
                      <option value="4">4</option>
                      <option value="5">5</option>
                    </select>
                  </div>

    </div>
    <div class='form-group container question-class question-div-8' id='8'>
            <h3>Would you say you are following your own journey?</h3>
            <div class="input-group mb-3">
                    <div class="input-group-prepend">
                      <label class="input-group-text" for="inputGroupSelect01">Options</label>
                    </div>
                    <select class="custom-select" id="8">
                      <option value="select">Select</option>
                      <option value="1">1</option>
                      <option value="2">2</option>
                      <option value="3">3</option>
                      <option value="4">4</option>
                      <option value="5">5</option>
                      </select>
                  </div>

    </div>
    <div class='form-group container question-class question-div-9' id='9'>
            <h3>Would you say you've had a hard past?</h3>
            <div class="input-group mb-3">
                    <div class="input-group-prepend">
                      <label class="input-group-text" for="inputGroupSelect01">Options</label>
                    </div>
                    <select class="custom-select" id="9">
                      <option value="select">Select</option>
                      <option value="1">1</option>
                      <option value="2">2</option>
                      <option value="3">3</option>
                      <option value="4">4</option>
                      <option value="5">5</option>                               
                     </select>
                  </div>

    </div>
    <div class='form-group container question-class question-div-10' id='10'>
            <h3>How likely are you to choose Chris Harrison instead of The Batchelor?</h3>
            <div class="input-group mb-3">
                    <div class="input-group-prepend">
                      <label class="input-group-text" for="inputGroupSelect01">Options</label>
                    </div>
                    <select class="custom-select" id="10">
                      <option value="select">Select</option>
                      <option value="1">1</option>
                      <option value="2">2</option>
                      <option value="3">3</option>
                      <option value="4">4</option>
                      <option value="5">5</option>
                    </select>
                  </div>

    </div>


<!-- Modal -->
<button type="submit" id="submit" class="btn btn-success" data-toggle="modal" data-target="#exampleModalCenter">Submit</button>

<div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLongTitle"></h5>
      </div>
      <div class="modal-body" id="displayChosenBachelor"></div>
      <div class="modal-footer">
        <button type="button" id="modalclose" class="btn btn-secondary" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
      </form>
</body>
</html>
<script text = "Javascript">
  var score;
  var match;
  var msg;
  var name = $(".name")[0];
  var imgurl = $(".imgurl")[0];
  var bachelorModal = $("#displayChosenBachelor");
  var modalH5 = $("#exampleModalLongTitle");

  $("#submit").click(function(event){
      event.preventDefault();
      var newBachelor = { //user object
          name: $("#name").val().trim(),
          image: $("#imgurl").val().trim(),
          scores: [],
          match: match,
          message: msg
      };

      function getScores(){ //gets the scores from questions
          $.each($(".custom-select option:selected"), function(){
          var answers = parseInt($(this).val());  
          newBachelor.scores.push(answers);
          if(answers === NaN){
          throwError();
          };
      });
      };
      getScores();
      $.post("/api/bachelors", newBachelor,
      function(data) {

      if (data) {
        console.log("success");
        runBachelorQuery();
      }

      else {
        throwError();
      };

      $("#name").val("");
      $("#imgurl").val("");
      // $(".custom-select").val("");
    });


    function runBachelorQuery() {
      
$.ajax({ url: "/api/bachelors", data: newBachelor, method: "GET" })
.then(function(Bachelors) {
  var index = Bachelors.length - 1;
  var message = Bachelors[index].message;
  console.log(Bachelors[index].match);
  var myMatch = Bachelors[index].match;
  console.log("------------------------------------");
  modalH5.text("Your Match:")
  bachelorModal.append("<h2>"+myMatch.name+"</h2>")
  bachelorModal.append("<img src='"+myMatch.image+"' class='img-fluid rounded float-left' alt='chris harrison'>");
  
  });
};


      console.log("myscores", newBachelor.scores);

    function throwError(){
        modalH5.text("Error!")
        bachelorModal.append("<h2>Please fill out all fields</h2>");
    };

  });

  $("#modalclose").on("click", function(event){
    modalH5.text("");
    bachelorModal.empty();
  });



 


</script>